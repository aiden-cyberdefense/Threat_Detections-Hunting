# Work in progress

$maliciousKeywords = @("malware","virus","trojan","attackers","malicious","proof of concept"," poc ","cve-20","zero-day","zero day","payload","obfuscate","exploiting cve-","exploit cve-","weaponisation","impersonate ","retrieve lots of passwords","retrieve passwords","post-exploitation"," in memory","reverse shell","reverseshell","reverse-shell","revshell","a beacon","av bypass","detected by microsoft defender","educational purposes","explicit permission","you are responsible","avoiding detection","on the victim","to avoid detection","encrypted shell","mimikatz","detected by amsi","keylog","scraper","hashdump","nessus","meterpreter","metasploit","rapid7","portscan","rce","65535","vulnerable-target","vulerable target","poc framework","learning purposes","the responsibility of the user","any responsibility for this","ransomware","c2 server","exfiltrate files","undetected by traffic inspection","bypassing user-mode","bypass the user-mode","red teaming","phishing","victim's browser"," the victim","impacket","restricted network environments","keystroke","forkbomb","bypasslogon","backdoor","buffer overflow","exploitation tool"," parrot","backbox"," kali ","offensive security","bruteforce","penetration test","pentest","good purposes","criminal","redteam","red team"," ctf ","penetration testing","kali linux","backtrack","vulnerability check","an attacker","bypassing dlp","exfiltrating data"," ddos ","syn flood","data exfiltration","scanning internal ports"," vulnerability ","subnet scan","port scan","post exploitation","lateral movement","shellcode","fileless","cobalt strike","cobaltstrike","www.fireeye","customized attacks","attacks against","brute forc","sql injection","sqlinjection","sqli"," vulnerabilities","ssrf","command injection","random proxy","random useragent","bad guy","proper authorization","breach dump","credential overlap","compromise account","bypass defense","abuse command","credential stuffing","responsibility for your actions","rce exploit","exploit for","an exploit ","remote code execution","-rce","exploit server","the exploit","exploit/","exploit.","privilege escalation","purple team","purpleteam","shodan","privesc","steal secret","escalate privileges","c2 framework"," into memory","system level permissions","system permissions","abuse print","achieve persistence","establish persistence","login hook","enumerate browser","enumerate user","hijack","intercept information","password guessing","guess login","password cracking","credential dump","obtain password","abuse internet browser","loaded assemblies","persistence commands","user enumeration","enumeration tool","user finder","password spraying","password spray","cleartext passwords","breach compilation","hunter.io","weleakinfo","leak-lookup","evilcorp","apt attack","endpoint detection","compromise assessment tools","test your soc","remote execution","creds dump","credentials dump","rootkit","pass the hash","pass-the-hash","golden ticket","fakeeav","fake av"," stealer","spyware","worms","adware","cryptomin","avoiding early detection","avoid detection","c2 connect","obtain hashed credentials","cache injection","dumping the lsass","dumping lsass","dump lsass","cached credentials","lsa secrets","impersonating user","impersonate user","impacket","lsass dump","procdump","obfuscated","obfuscation","remote execution tool","pwdump","command and control","c&c","defense evasion","dropper","web shell","webshell","adversary emulation","kerberos relay","spoofing","spoofed","attacks","elevate privilege","abuse elevation","bypass uac","uac bypass","sudo caching","elevated execution with prompt","access token manipulation","token impersonation","token theft","evade process-monitoring","sid-history injection","account access removal","account discovery","dump exchange address","account manipulation","victim systems","victim network","automated exfiltration","compromised system","abuse authentication","abuse feature","abuse security","bypass password","victim accounts ","botnet","exfiltration over","active scanning","victim ip","vulnerability scanning","scan victims","brute-forc","crawling","wordlist scan","gather victim","adversary-in-the-middle","sniffing","poisoning","llmnr/nbt-ns","smb relay","elevate process privileges","elevate its privileges","bypass user account control","hacktool","exploit","keylogger","arpspoof","injector","sniffer","cryptolocker","spyeye","packer","cryptowall","darknet","wannacry","stuxnet","hydra","arp flood","arpflood","nuker","spammer","bruteforc","hacker","hacking","password crack","password hacking","password breach","password attack","password stealer","vulnerable software","vulnerability scann","vulnerability exploitation","zeroday","spoofprevention","vulnerabilityprevention","bypass antivirus","dataleakage","dataleak","social engineering","ddos","brute force","spam","cryptography","web application firewall","xss","honeypot","network sniffing","arp poisoning","data leakage","steganography","ip spoofing","denial of service","reverse engineering","ip address","firewall","man in the middle","remote access","password hashing","code injection","script kiddie","ddos attack","port scanning","cryptojacking","data theft","packet sniffing","cross site request forgery","network scanning","wireless hacking","data mining","social network hacking","exploit kit","keystroke logging","clickjacking","wifi cracking","pharming","spear phishing","packet crafting","dns poisoning","cross site scripting","directory traversal","scanning","header manipulation","keylogging","password sniffing","cipher","zero-day exploit","exploit development","wifi jamming","cookie stealing","botnet analysis","social engineering attack","system hacking","file inclusion","access control","session hijacking","binary exploitation","cross-site request forgery","buffer overflow attack","dns tunneling","network spoofing","malware analysis","phishing attack","pre-auth exploitation","web application attack","cryptanalysis","command execution","side-channel analysis","exploit database","software manipulation","cross-origin resource sharing","wireless exploitation","man-in-the-browser attack","vulnerability ","exploitation ","penetration testing ","network scanning ","risk assessment ","firewall ","intrusion detection ","malware ","phishing ","social engineering ","botnet ","password cracking ","encryption ","privilege escalation ","buffer overflow ","wireless security ","security audit ","log analysis ","honeypot ","network forensics ","reverse engineering ","web application security ","sql injection ","cross-site scripting ","application security ","data leakage ","system hardening ","application patching ","data backup ","data privacy ","access control ","denial of service ","rootkit ","biometrics ","single sign-on ","network segmentation ","antivirus ","sandboxing ","endpoint protection ","patch management ","trojan ","ddos ","vlan ","ips ","ids ","honeynet ","web server security ","system logging ","data destruction ","file integrity monitoring ","network monitoring ","wireless monitoring ","mobile security ","ddos mitigation ","email security ","data classification ","cloud security ","siem ","network traffic analysis ","network access control ","software security ","infrastructure security ","identity management ","secure coding ","network architecture ","database security ","application security testing ","cloud security testing ","physical security ","secure architecture ","security policies ","process control ","firewall control ","security awareness ","security controls ","event logging ","security posture ","network vulnerability ","network authentication ","network monitoring tools ","network security protocols ","network device monitoring ","network access control lists ","network intrusion detection ","network security assessment ","network forensics tools ","network security analytics ","network security best practices ","endpoint security ","endpoint threat detection ","endpoint security solutions ","endpoint security management ","endpoint protection solutions ","endpoint protection platform ","endpoint security analytics ","endpoint security best practices ","cloud security solutions ","cloud security services ","cloud security assessment","vulnerability","intrusion detection","network mapping","digital forensics","network security","security scanning","cross-site scripting","encryption","network hardening","data loss prevention","zero-day attack","whitelisting","security auditing","endpoint protection","data diodes","antivirus","key logging","cyber warfare","input validation","application security","biometrics","system hardening","protocol analysis","trojan horse","content filtering","web application scanning","network monitoring","data encryption","security awareness","zero trust model","data masking","covert channels","network segmentation","identity management","siem","sandboxing","mobile security","intrusion prevention","data destruction","patch management","web application security","command & control","anti-spam","key management","role-based access control","physical security","ddos protection","two-factor authentication","network access control","honey token","application firewall","software defined perimeter","event logging","network isolation","cloud security","secure socket layer","file integrity monitoring","reverse proxy","data rights management","secure erase","geolocation","identity theft","server hardening","network intrusion","rogue access point","blockchain security","risk analysis","host-based firewall","cloud access security broker","virtual private network","end-to-end encryption","man-in-the-middle attack","replay attack","distributed denial of service","server hacking","dns hijacking","email spoofing","arp spoofing","root access","password harvesting","cross-site flashing","smurf attack","unauthorized access","drive-by attack","malvertising","shimming","structured query language injection","zero width space","eavesdropping","phishing domain","watering hole attack","shellshock","duckduckgo","domain hijacking","cross-site tracing","wifi hacking","zombie attack","man-in-the-browser","xss worm","http response splitting","regex injection","dns cache poisoning","trap door","password reuse","remote file inclusion","cross-site history manipulation","salami attack","rogue wi-fi access point","dns spoofing","code reuse","dns amplification","mobile malware","badusb","teardrop attack","covert channel","dns rebinding","session fixation","xss polyglot","structured query language","hacking","brute-forcing","cookie theft","reflection attack","crypto attack","script kiddies","smurfing","script injection","buffer underflow","denial of service attack","spear fishing","drive-by download","intercepting proxy","wireless eavesdropping","brownout attack","logic bomb","data diddling","worm","grey hat","cryptocurrency mining","symlink attack","cross-site request hijacking","ping of death","denial-of-service attack","click-fraud","mobile phishing","data tampering","web skimming","screen scraping","scareware","social media attack","privilege abuse","cookie poisoning","mail bombing","header injection","brute force attack","binary planting","file sharing attack","evil twin attack","sms spoofing","web-based attack","identity spoofing","backdoors","rootkits","man-in-the-middle","mitm","exploit kits","application ddos","remote access trojans","arbitrary file upload","directory harvesting","drive-by-downloads","fake antivirus","botnets","spamming","xml injection","insufficient authorization","business logic flaws","heap overflow","integer overflow","poison ivy","token manipulation","abuse of functionality","parameter manipulation","unvalidated redirects","direct memory access","directory indexing","click fraud","website tampering","web cache poisoning","information disclosure","cleartext storage","buffer manipulation","cross-site request overwriting","value injection","web service attacks","dll injection","wireless network hacking","botnet command and control","distributed denial of service attacks","cross-site scripting protection","open source intelligence","network reconnaissance","code signing","password cracking tools","denial of service tools","web shells","information gathering","url manipulation","password attacks","dos","credential theft","land attack","social networking scams","malicious website","malicious software","port redirection","drive-by downloads","ip address hijacking","browser hijacking","keylogger installation","hashing","dns redirection","virus scanning","executable file scanning","fileless attack","dumpster diving","internet worms","network tap","social engineering attacks","side channel attacks","server side request forgery","zero day exploits","rainbow tables","honeypots","voice phishing","gain access","impersonation","brute force attacks","arbitrary code execution","malware payloads","xsrf","reflected file download","fake profiles","fake accounts","fileless malware","cryptocurrency theft","bitcoin mining","bitcoin theft","monero mining","monero theft","ethereum mining","cyberknife","wireshark","snort","nmap","aircrack-ng","cain & abel","ollydbg","hashcat","xss shell","thc hydra","dirbuster","kismet","packet sniffer","payload delivery","exploit writing","antivirus evasion","icmp flood","null session exploit","application vulnerability scan","intrusion detection system","session splicing","data obfuscation","exploit frameworks","ldap injection","decompiling","physical access","ciphertext attacks","file format exploits","data manipulation","sql truncation","session sniffing","re-transmission attack","malicious proxies","rogue wireless access point","rogue dns server","advanced persistent threat","exploit delivery","side channel attack","decryption","nimda","mydoom","code red","sql slammer","blaster","sasser","conficker","duqu","zeus","melissa","petya","iloveyou","w32/blaster","winnti","ms08-067","ms06-040","ms04-011","ms03-026","ms02-061","magistr","reatle","ramen","hybris","rpc dcom","msblast","eternalblue","notpetya","shamoon","blackenergy","darktequila","flame","zeroaccess","netsky","stuxnet 2.0","adylkuzz","duqu 2.0","airhopper","titan rain","lockergoga","careto","sakula","kazy","gamera","bad rabbit","finfisher","plugx","gameover zeus","duqu trojan","taidoor","flame worm","miniduke","blackshades","sality","red october","gh0st","aurora","night dragon","moonlight maze","mydoom worm","kama sutra","downadup","zeus trojan","stuxnet worm","agent.btz","vundo","nitol","coreflood","stoned","zlob","rustock","tdl-4","poison ivy rat","sefnit","netsky.b","giot","netsky.p","backdoor.win32.hupigon.gen","win32/ramnit","stuxnet-a","win32/almanahe","win32/vb","win32/parite","win32/taterf","win32/rmnet","win32/tepfer","win32/lovgate","win32/grum","win32/beagle","win32/yaha","john the ripper","maltego","burp suite","owasp zap","ettercap","social engineering toolkit","setoolkit","netsparker","core impact","beef","ossec","networkminer","telnet","tcpdump","ncat","openvas","nikto","ncrack","armitage","p0f","sqlmap","xplico","insecure.org w3af","thc-ssl-dos","thc-ipv6","thc-amap","thc-scan","thc-hydra","dsniff","netcat","scapy","reaver","nmap scripting engine","netfilter","nmap nse","owasp","w3af","wpscan","firewalk","metagoofil","heartbleed","stuxnet ","eternalblue ","poodle","bluekeep","wannacry ","sambacry","ghost","sack panic","struts2","dirty cow","dirtycow","dirtyc0w","bash bug","meltdown","spectre","weevely","cain and abel","cookie cadger","zenmap","acunetix","scanssh","ophcrack","acccheck","dnsenum","netbus","netwitness investigator","retina","cloakify","dmitry","fuzzing","cewl","dirb","rainbow crack","sqlninja","smbaudit","skipfish","sipvicious","medusa","hopper","binwalk","koadic","cortana","footprint","creddump7","xsser","firestorm","credcrack","packet crafter","social-engineer toolkit","tcpflow","dnsrecon","loki","evilgrade","tunna","proxychains","routersploit","fsociety","empire","wifite","ipgeolocation","airmon-ng","scapy-ssl","sslstrip","aircrack-ptw","exploitpack","smbghost","oscp","a2sv","nishang","powershell empire","gobuster","ratdecoders","fireshell","dradis","sparta","veil","exploitdb","hping","sqlinjectme","flawfinder","cmsmap","vega","wce","the social-engineer toolkit")

$maliciousKeywords_temp = @("hacking","pentest","redteam","payload","exploit","poc","vulnerability","vulnerabilities","exploits","security","hacktools","infosec","phishing")

$topicpages = @()
foreach ($keyword in $maliciousKeywords_temp){
  $page = "https://github.com/topics/$keyword?o=desc&s=updated"
  $topicpages+=$page
}

foreach($page in topicpages){
  $resultpage = (Invoke-WebRequest -Uri $page).Content
  [regex]::Matches($resultpage, 'action\=\"(.*?)\/unstar').Value
}



#----------------------------------------------------------#
# Check if the github repo contains any malicious keywords #
#----------------------------------------------------------#




Function Check_Keywords {
    param (
        [Parameter(Mandatory = $true)]
        [String] $page,
        [String] $Arg2
    )
    Write-Host "Argument 1: $Arg1"
    Write-Host "Argument 2: $Arg2"

    $reponame = "thezdi/PoC"
    $repoURL = "https://github.com/$reponame"
    $readmeURL = "https://raw.githubusercontent.com/$reponame/master/README.md"

    $result = (Invoke-WebRequest -Uri $repoURL).Content
    # Get the content of the README.md file
    $readmeContent = Invoke-WebRequest -Uri $readmeURL -Method Get

    # Extract the description, title and README from the page
    $description = ([regex]::Matches($result, 'meta name=\"description\" content=\"(.*?)\"').Groups[1].Value)
    $title = ([regex]::Matches($result, '<title>(.*?)</title>').Groups[1].Value)
    $topics = ([regex]::Matches($result, '"topic\:(.*?)\"\s').Value)


    $keywordcount = 0

    foreach ($keyword in $maliciousKeywords)
    {
        if ($description -match $keyword -or $title -match $keyword -or $readme -match $keyword  -or $topics -match $keyword -or $readmeContent -match $keyword)
        {
            Write-Host "Malicious keyword $keyword found in $repoURL"
            $keywordcount++
        }
    }

    Write-Host "/!\ $keywordcount malicious keywords detected"

    if ($keywordcount -gt 1){
      $csvFile = "$PSScriptRoot\offensive_tools_list_to_confirm.csv"
      Add-Content $csvFile $repoURL
}
}
